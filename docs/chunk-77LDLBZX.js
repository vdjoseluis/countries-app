import{a as h}from"./chunk-KLQYZYXN.js";import{$ as p,C as n,I as u,U as r,W as l,n as i,r as s,s as c}from"./chunk-TAAER7OC.js";var g=class a{constructor(t){this.http=t;this.loadFromLocalStorage()}apiUrl="https://restcountries.com/v3.1";saveToLocalStorage(){localStorage.setItem("cacheStore",JSON.stringify(this.cacheStore))}saveFavourite(t){return this.favourites.countries.find(o=>o.cca3===t.cca3)?"Country already exists !":(this.favourites.countries=[...this.favourites.countries,t],localStorage.setItem("favourites",JSON.stringify(this.favourites)),"Country added to favourites")}loadFromLocalStorage(){!localStorage.getItem("cacheStore")&&!localStorage.getItem("favourites")||(this.cacheStore=JSON.parse(localStorage.getItem("cacheStore")),this.favourites=JSON.parse(localStorage.getItem("favourites")))}cacheStore={byCapital:{term:"",countries:[]},byCountry:{term:"",countries:[]},byRegion:{region:"",countries:[]}};favourites={countries:[]};getCountriesRequest(t){return this.http.get(t).pipe(n(()=>i([])),u(300))}searchCountryByCode(t){return this.http.get(`${this.apiUrl}/alpha/${t}`).pipe(s(e=>e.length>0?e[0]:null),n(()=>i(null)))}searchCapital(t){return this.getCountriesRequest(`${this.apiUrl}/capital/${t}`).pipe(r(e=>this.cacheStore.byCapital={term:t,countries:e}),r(()=>this.saveToLocalStorage()))}searchCountry(t){return this.getCountriesRequest(`${this.apiUrl}/name/${t}`).pipe(r(e=>this.cacheStore.byCountry={term:t,countries:e}),r(()=>this.saveToLocalStorage()))}searchRegion(t){return this.getCountriesRequest(`${this.apiUrl}/region/${t}`).pipe(r(e=>this.cacheStore.byRegion={region:t,countries:e}),r(()=>this.saveToLocalStorage()))}getCountryByAlphaCode(t){let e=`${this.apiUrl}/alpha/${t}?fields=cca3,name,borders`;return this.http.get(e).pipe(s(o=>o))}getCountriesBordersByCodes(t){if(!t||t.length===0)return i([]);let e=[];return t.forEach(o=>{let y=this.getCountryByAlphaCode(o);e.push(y)}),c(e)}static \u0275fac=function(e){return new(e||a)(p(h))};static \u0275prov=l({token:a,factory:a.\u0275fac,providedIn:"root"})};export{g as a};
